config main
    option gatewayid
    option gatewayinterface
    option gatewayaddress
    option gatewayport

    option proxyport
    option externalinterface
    option htmlmessagefile
    option daemon
    option checkinterval
    option timeout

    option httpdname
    option httpdmaxconn
    option httpdrealm
    option httpdusername
    option httpdpassword


config trustedmaclist 
    list macaddr EC:17:2F:82:E9:A3
    list macaddr EC:17:2F:82:E9:A2
    list macaddr 74:E5:0B:6A:4B:8A


config authserver local
    option hostname "192.168.0.220"
    option sslavailable "no"
    option sslport "443"
    option httpport "80"
    option path "/wifidog/"
    option loginscriptpathfragment "login/?"
    option portalscriptpathfragment "portal/?"
    option msgscriptpathfragment "gw_message.php?"
    option pingscriptpathfragment "ping/?"
    option authscriptpathfragment "auth/?"


config authserver local
    option hostname "192.168.0.240"
    option sslavailable "no"
    option sslport "443"
    option httpport "80"
    option path "/wifidog/"
    option loginscriptpathfragment "login/?"
    option portalscriptpathfragment "portal/?"
    option msgscriptpathfragment "gw_message.php?"
    option pingscriptpathfragment "ping/?"
    option authscriptpathfragment "auth/?"


config firewallruleset global
    # firewallrule (block|drop|allow|log|ulog) [(tcp|udp|icmp) [port X]] [to IP/CIDR]

    ## To block SMTP out, as it's a tech support nightmare, and a legal liability
    # option firewallrule "block tcp port 25"
    
    ## Use the following if you don't want clients to be able to access machines on 
    ## the private LAN that gives internet access to wifidog.  Note that this is not
    ## client isolation;  The laptops will still be able to talk to one another, as
    ## well as to any machine bridged to the wifi of the router.
    # option firewallrule "block to 192.168.0.0/16
    # option firewallrule "block to 172.16.0.0/12
    # option firewallrule "block to 10.0.0.0/8
    
    ## This is an example ruleset for the Teliphone service.
    # option firewallrule "allow udp to 69.90.89.192/27
    # option firewallrule "allow udp to 69.90.85.0/27
    # option firewallrule "allow tcp port 80 to 69.90.89.205

    ## Use the following to log or ulog the traffic you want to allow or block.
    # Note: the log or ulog rule must be passed before, the rule you want to match.
    # for openwrt: use of these feature requires modules ipt_LOG or ipt_ULOG present in dependencies
    # iptables-mod-extra and iptables-mod-ulog
    # For example, you want to log (ulog works the same way) the traffic allowed on port 80 to the ip 69.90.89.205:
    # option firewallrule "log tcp port 80 to 69.90.89.205"
    # option firewallrule "allow tcp port 80 to 69.90.89.205"
    # And you want to know, who matche your block rule:
    # option firewallrule "log to 0.0.0.0/0"
    # option firewallrule "block to 0.0.0.0/0"

# Rule Set: validating-users - Used for new users validating their account
config firewallruleset validating-users
    option firewallrule 'allow to 0.0.0.0/0'


# Rule Set: known-users - Used for normal validated users.
config firewallruleset known-users
    option firewallrule "allow to 0.0.0.0/0"


# Rule Set: unknown-users - Used for unvalidated users, this is the ruleset that gets redirected.
## XXX The redirect code adds the Default DROP clause.
config firewallruleset unknown-users {
    option firewallrule "allow udp port 53"
    option firewallrule "allow tcp port 53"
    option firewallrule "allow udp port 67"
    option firewallrule "allow tcp port 67"

# Rule Set: locked-users - Not currently used
config firewallruleset locked-users
    option firewallrule "block to 0.0.0.0/0"
